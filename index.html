<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buscar Pel√≠cula Compat√≠vel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes blink {
            0% { background-color: #facc15; }
            50% { background-color: transparent; }
            100% { background-color: #facc15; }
        }
        .highlight {
            animation: blink 1s infinite;
            padding: 2px;
            border-radius: 3px;
            font-weight: bold;
            font-style: italic;
        }
        body {
            background-color: black;
        }
        .shake {
            animation: shake 0.3s;
        }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }
        .card-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: stretch;
        }
        .card {
            width: 250px;
            padding: 20px;
            border-radius: 10px;
            color: white;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .blue-card {
            background: linear-gradient(to right, #3b82f6, #1e3a8a);
        }
        .yellow-card {
            background: linear-gradient(to right, #facc15, #d97706);
        }
        .button-size {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
            display: block;
            margin-top: auto;
        }
    </style>
</head>
<body class="text-gray-900">
    <div class="max-w-lg mx-auto mt-10 p-6 bg-gray-100 rounded-lg shadow-lg">
        <h1 class="text-center text-2xl font-bold text-white bg-yellow-500 p-3 rounded-lg">
            Buscar Pel√≠cula Compat√≠vel
        </h1>

        <div id="loginSection">
            <label class="block mt-4 text-sm font-medium text-gray-700">Digite seu e-mail para acessar</label>
            <input type="email" id="email" placeholder="Digite seu e-mail" class="w-full mt-1 p-2 border border-gray-300 rounded-lg">
        <button onclick="enviarCodigoSupabase()" class="w-full mt-4 bg-blue-500 text-white p-2 rounded-lg shadow-md hover:bg-blue-600 transition">
                üîë Entrar
            </button>

            <div class="card-container mt-6">
                <div class="card blue-card">
                    <h2 class="text-xl font-bold">Vers√£o PRO</h2>
                    <ul class="mt-4 text-sm">
                        <li>‚úÖ Acesso a todas as pel√≠culas</li>
                        <li>üîÑ Atualiza√ß√µes semanais</li>
                        <li>‚ö° Suporte priorit√°rio</li>
                        <li>üö´ Sem propagandas</li>
                    </ul>
                    <p class="mt-4 text-2xl font-bold">R$ 9,90 <span class="text-sm">/m√™s</span></p>
                    <button class="button-size bg-pink-500 text-white shadow-md hover:bg-pink-600 transition">
                        üí≥ Assinar Agora
                    </button>
                </div>

                <div class="card yellow-card">
                    <h2 class="text-xl font-bold">Acervo de Esquemas</h2>
                    <ul class="mt-4 text-sm">
                        <li>üìÇ Mais de 1000 esquemas</li>
                        <li>üíæ Download ilimitado</li>
                        <li>üõ† Acesso vital√≠cio</li>
                        <li>üöÄ Sem mensalidades</li>
                    </ul>
                    <p class="mt-4 text-2xl font-bold">R$ 90,00 <span class="text-sm">√∫nico</span></p>
                    <a href="https://www.esquemaeletrico.com/menu-principal" class="button-size bg-green-500 text-white shadow-md hover:bg-green-600 transition text-center block">
                        üì• Comprar Agora
                    </a>
                </div>
            </div>
        </div>

        <div id="searchSection" class="hidden">
            <div class="mt-4 p-4 bg-gray-200 text-center text-lg font-semibold rounded-lg shadow-md">
                Bem-vindo(a)! Agora voc√™ pode buscar pelas pel√≠culas compat√≠veis.
            </div>

            <label class="block mt-4 text-sm font-medium text-gray-700">Digite o modelo do celular</label>
            <input type="text" id="searchModel" placeholder="Digite o modelo" class="w-full mt-1 p-2 border border-gray-300 rounded-lg">
            
            <div id="result" class="mt-4 p-3 bg-gray-200 rounded-lg shadow-md hidden font-bold"></div>

            <a href="https://wa.me/utidatecnologia" target="_blank" class="w-full mt-4 bg-green-500 text-white p-2 rounded-lg shadow-md hover:bg-green-600 transition text-center block">
                üßë‚Äçüíª Suporte
            </a>
        </div>
    </div>

    <footer class="text-center mt-10 text-sm text-gray-400">
        Copyright &copy; 2021 UTI Da Tecnologia - Todos os Direitos Reservados.<br>
        Desenvolvido por <strong>Carla Vasconcelos</strong> (UTI Da Tecnologia).
    </footer>

    <script>
        let data = [];

        function checkEmail() {
            const email = document.getElementById('email').value;
            const loginSection = document.getElementById('loginSection');

            fetch('https://script.google.com/macros/s/AKfycbxzqF6pTZC1m-krKC28anmV9viQgD7DKpK67rl8nKx1VCxLspBvQncE0rxXsvIchC0jYA/exec')
                .then(response => response.json())
                .then(emails => {
                    if (emails.includes(email)) {
                        alert('‚úÖ Acesso permitido!');
                        loginSection.classList.add('hidden');
                        document.getElementById('searchSection').classList.remove('hidden');
                        loadData();
                    } else {
                        loginSection.classList.add('shake');
                        setTimeout(() => loginSection.classList.remove('shake'), 300);
                        alert('‚ùå Acesso negado!');
                    }
                });
        }

        function loadData() {
            fetch('https://script.google.com/macros/s/AKfycbwiDM-VA66hS8pnAGghwY2vxL3vqrRp9SIHmGc5AkwlMZeMYXg_An3dCvoJQUq6mJWTuA/exec')
                .then(response => response.json())
                .then(jsonData => {
                    data = jsonData.map(row => row[0].trim().toUpperCase().split(',').map(m => m.trim()));
                });
        }

        function searchModel() {
            const searchModel = document.getElementById('searchModel').value.toUpperCase().trim();
            const resultElement = document.getElementById('result');

            if (searchModel === "") {
                resultElement.classList.add('hidden');
                return;
            }

            let foundRows = data.flatMap(row =>
                row.some(model => model.includes(searchModel)) ? 
                [`Modelo Procurado: <strong>${searchModel}</strong> <br> Modelos Compat√≠veis: ${row.map(m => m.includes(searchModel) ? `<span class='highlight'>${m}</span>` : m).join(', ')}`] : []
            );

            resultElement.innerHTML = foundRows.length > 0 ? foundRows.join('<br><br>') : "<strong>Modelo n√£o encontrado</strong>";
            resultElement.classList.remove('hidden');
        }

        document.getElementById('searchModel').addEventListener('input', searchModel);
    </script>
<!-- Supabase JS -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
    const supabaseUrl = 'https://chjdjfycylqhxtfrbdxm.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNoamRqZnljeWxxaHh0ZnJiZHhtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDIxNTg0MTYsImV4cCI6MjA1NzczNDQxNn0.GvMeSnBDF0CS9-uampycS-C4qqfMgTzSsjYGqHrOFXU';
    const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);
async function enviarCodigoSupabase() {
    const email = document.getElementById('email').value;

    let { data, error } = await supabaseClient.auth.signInWithOtp({ email });

    if (error) {
        alert('‚ùå Erro ao enviar c√≥digo!');
        console.error(error);
    } else {
        alert('‚úÖ C√≥digo enviado ao seu e-mail! Verifique a caixa de entrada.');
    }
}
async function verificarSessao() {
    const { data: { session } } = await supabaseClient.auth.getSession();

    if (session) {
        document.getElementById('loginSection').classList.add('hidden');
        document.getElementById('searchSection').classList.remove('hidden');
        loadData();
        alert('‚úÖ Usu√°rio logado com sucesso!');
    }
}

window.onload = verificarSessao;
</script>
</body>
</html>
